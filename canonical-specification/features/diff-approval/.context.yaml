# Context Manifest for diff-approval
# Auto-generated by canon-check on 2026-01-21
# Version: 0.5.0

feature: diff-approval
canon_version: 0.5.0
status: complete
confidence: 0.95

# Summary: What this feature does
summary: |
  Per-hunk diff approval system allowing users to review and selectively apply
  LLM-proposed file changes. Uses unified diff format with granular hunk-level
  control, blocking UI (recursive-edit), and immediate file application.
  Exemplary spec fidelity (100% adherence to DIFF-IMPLEMENTATION.AGENT.md).

# Essential context: Always load these for basic understanding
essential:
  - path: "core/foundation/vocabulary.md"
    reason: "Domain terms: Tool (diff-approval is a tool)"
    sections: ["Tool"]
    token_estimate: 200

  - path: "features/diff-approval/feature.yaml"
    reason: "Feature overview, architecture notes (blocking UI pattern)"
    token_estimate: 500

  - path: "features/diff-approval/contracts/propose-file-edit.md"
    reason: "Core contract: propose_file_edit tool (unified diff format)"
    token_estimate: 400

# Per-contract context: Load when working on specific contracts
per_contract:
  propose-file-edit:
    - path: "features/diff-approval/scenarios/propose-edit.md"
      reason: "Primary scenario: LLM proposes edit, user reviews"
      token_estimate: 300
    - path: "features/diff-approval/scenarios/accept-selective-hunks.md"
      reason: "Demonstrates per-hunk approval (key feature)"
      token_estimate: 250

# Reference context: Load for deep work or related areas
reference:
  - path: "features/diff-approval/properties/hunk-state-machine.md"
    reason: "Invariant: pending â†’ accepted/rejected state transitions"
    token_estimate: 300

  - path: "features/diff-approval/properties/irreversibility.md"
    reason: "Invariant: applied hunks cannot be unapplied from UI"
    token_estimate: 200

  - path: "features/diff-approval/properties/decision-logic.md"
    reason: "Invariant: decision string protocol (accepted/rejected)"
    token_estimate: 250

  - path: "features/diff-approval/scenarios/verification-mismatch.md"
    reason: "Edge case: file content doesn't match old_string"
    token_estimate: 200

# Dependencies: Related features to consider
dependencies:
  - feature: tool-system
    reason: "Diff-approval is registered as a tool (:dangerous safety level)"

  - feature: chat-interface
    reason: "Displays diff results in chat"

# Metadata
generated: 2026-01-21T14:25:00Z
total_token_estimate: 2600
